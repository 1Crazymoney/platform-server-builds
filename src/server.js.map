{"version":3,"sources":["../../../../modules/@angular/platform-server/src/server.ts"],"names":[],"mappings":"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","file":"server.js","sourceRoot":"","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {PlatformLocation} from '@angular/common/index';\nimport {platformCoreDynamic} from '@angular/compiler/index';\nimport {APP_BOOTSTRAP_LISTENER, Injectable, InjectionToken, Injector, NgModule, PLATFORM_INITIALIZER, PlatformRef, Provider, RENDERER_V2_DIRECT, RendererV2, RootRenderer, createPlatformFactory, isDevMode, platformCore} from '@angular/core/index';\nimport {HttpModule} from '@angular/http/index';\nimport {BrowserModule, DOCUMENT} from '@angular/platform-browser/index';\n\nimport {SERVER_HTTP_PROVIDERS} from './http';\nimport {ServerPlatformLocation} from './location';\nimport {Parse5DomAdapter, parseDocument} from './parse5_adapter';\nimport {PlatformState} from './platform_state';\nimport {ALLOW_MULTIPLE_PLATFORMS, DebugDomRendererV2, DebugDomRootRenderer} from './private_import_core';\nimport {SharedStylesHost, getDOM} from './private_import_platform-browser';\nimport {ServerRendererV2, ServerRootRenderer} from './server_renderer';\nimport {ServerStylesHost} from './styles_host';\nimport {INITIAL_CONFIG, PlatformConfig} from './tokens';\n/**\n * @param {?} feature\n * @return {?}\n */\nfunction notSupported(feature: string): Error {\n  throw new Error(`platform-server does not support '${feature}'.`);\n}\n\nexport const /** @type {?} */ INTERNAL_SERVER_PLATFORM_PROVIDERS: Array<any /*Type | Provider | any[]*/> = [\n  {provide: DOCUMENT, useFactory: _document, deps: [Injector]},\n  {provide: PLATFORM_INITIALIZER, useFactory: initParse5Adapter, multi: true, deps: [Injector]},\n  {provide: PlatformLocation, useClass: ServerPlatformLocation}, PlatformState,\n  // Add special provider that allows multiple instances of platformServer* to be created.\n  {provide: ALLOW_MULTIPLE_PLATFORMS, useValue: true}\n];\n/**\n * @param {?} injector\n * @return {?}\n */\nfunction initParse5Adapter(injector: Injector) {\n  return () => { Parse5DomAdapter.makeCurrent(); };\n}\n/**\n * @param {?} rootRenderer\n * @return {?}\n */\nexport function _createConditionalRootRenderer(rootRenderer: any) {\n  return isDevMode() ? new DebugDomRootRenderer(rootRenderer) : rootRenderer;\n}\n/**\n * @param {?} renderer\n * @return {?}\n */\nexport function _createDebugRendererV2(renderer: RendererV2): RendererV2 {\n  return isDevMode() ? new DebugDomRendererV2(renderer) : renderer;\n}\n/**\n * @param {?} stylesHost\n * @return {?}\n */\nexport function _addStylesToRootComponentFactory(stylesHost: ServerStylesHost) {\n  const /** @type {?} */ initializer = () => stylesHost.rootComponentIsReady();\n  return initializer;\n}\n\nexport const /** @type {?} */ SERVER_RENDER_PROVIDERS: Provider[] = [\n  ServerRootRenderer,\n  {provide: RENDERER_V2_DIRECT, useClass: ServerRendererV2},\n  {provide: RendererV2, useFactory: _createDebugRendererV2, deps: [RENDERER_V2_DIRECT]},\n  {provide: RootRenderer, useFactory: _createConditionalRootRenderer, deps: [ServerRootRenderer]},\n  ServerStylesHost,\n  {provide: SharedStylesHost, useExisting: ServerStylesHost},\n  {\n    provide: APP_BOOTSTRAP_LISTENER,\n    useFactory: _addStylesToRootComponentFactory,\n    deps: [ServerStylesHost],\n    multi: true\n  },\n];\n/**\n * The ng module for the server.\n * \n * \\@experimental\n */\nexport class ServerModule {\nstatic decorators: DecoratorInvocation[] = [\n{ type: NgModule, args: [{\n  exports: [BrowserModule],\n  imports: [HttpModule],\n  providers: [SERVER_RENDER_PROVIDERS, SERVER_HTTP_PROVIDERS],\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction ServerModule_tsickle_Closure_declarations() {\n/** @type {?} */\nServerModule.decorators;\n/**\n * @nocollapse\n * @type {?}\n */\nServerModule.ctorParameters;\n}\n\n/**\n * @param {?} injector\n * @return {?}\n */\nfunction _document(injector: Injector) {\n  let /** @type {?} */ config: PlatformConfig|null = injector.get(INITIAL_CONFIG, null);\n  if (config && config.document) {\n    return parseDocument(config.document);\n  } else {\n    return getDOM().createHtmlDocument();\n  }\n}\n\n/**\n * @experimental\n */\nexport const /** @type {?} */ platformServer =\n    createPlatformFactory(platformCore, 'server', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n\n/**\n * The server platform that supports the runtime compiler.\n *\n * @experimental\n */\nexport const /** @type {?} */ platformDynamicServer =\n    createPlatformFactory(platformCoreDynamic, 'serverDynamic', INTERNAL_SERVER_PLATFORM_PROVIDERS);\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}